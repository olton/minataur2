/*! 
 * MetroUI :: ChartJS - Create different charts in js
 * https://pimenov.com.ua
 *
 * Copyright 2023 Serhii Pimenov
 * Released under the MIT license
 */
!function(){"use strict";const t={aliceBlue:"#f0f8ff",antiqueWhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedAlmond:"#ffebcd",blue:"#0000ff",blueViolet:"#8a2be2",brown:"#a52a2a",burlyWood:"#deb887",cadetBlue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerBlue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkBlue:"#00008b",darkCyan:"#008b8b",darkGoldenRod:"#b8860b",darkGray:"#a9a9a9",darkGreen:"#006400",darkKhaki:"#bdb76b",darkMagenta:"#8b008b",darkOliveGreen:"#556b2f",darkOrange:"#ff8c00",darkOrchid:"#9932cc",darkRed:"#8b0000",darkSalmon:"#e9967a",darkSeaGreen:"#8fbc8f",darkSlateBlue:"#483d8b",darkSlateGray:"#2f4f4f",darkTurquoise:"#00ced1",darkViolet:"#9400d3",deepPink:"#ff1493",deepSkyBlue:"#00bfff",dimGray:"#696969",dodgerBlue:"#1e90ff",fireBrick:"#b22222",floralWhite:"#fffaf0",forestGreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#DCDCDC",ghostWhite:"#F8F8FF",gold:"#ffd700",goldenRod:"#daa520",gray:"#808080",green:"#008000",greenYellow:"#adff2f",honeyDew:"#f0fff0",hotPink:"#ff69b4",indianRed:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderBlush:"#fff0f5",lawnGreen:"#7cfc00",lemonChiffon:"#fffacd",lightBlue:"#add8e6",lightCoral:"#f08080",lightCyan:"#e0ffff",lightGoldenRodYellow:"#fafad2",lightGray:"#d3d3d3",lightGreen:"#90ee90",lightPink:"#ffb6c1",lightSalmon:"#ffa07a",lightSeaGreen:"#20b2aa",lightSkyBlue:"#87cefa",lightSlateGray:"#778899",lightSteelBlue:"#b0c4de",lightYellow:"#ffffe0",lime:"#00ff00",limeGreen:"#32dc32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumAquaMarine:"#66cdaa",mediumBlue:"#0000cd",mediumOrchid:"#ba55d3",mediumPurple:"#9370db",mediumSeaGreen:"#3cb371",mediumSlateBlue:"#7b68ee",mediumSpringGreen:"#00fa9a",mediumTurquoise:"#48d1cc",mediumVioletRed:"#c71585",midnightBlue:"#191970",mintCream:"#f5fffa",mistyRose:"#ffe4e1",moccasin:"#ffe4b5",navajoWhite:"#ffdead",navy:"#000080",oldLace:"#fdd5e6",olive:"#808000",oliveDrab:"#6b8e23",orange:"#ffa500",orangeRed:"#ff4500",orchid:"#da70d6",paleGoldenRod:"#eee8aa",paleGreen:"#98fb98",paleTurquoise:"#afeeee",paleVioletRed:"#db7093",papayaWhip:"#ffefd5",peachPuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderBlue:"#b0e0e6",purple:"#800080",rebeccaPurple:"#663399",red:"#ff0000",rosyBrown:"#bc8f8f",royalBlue:"#4169e1",saddleBrown:"#8b4513",salmon:"#fa8072",sandyBrown:"#f4a460",seaGreen:"#2e8b57",seaShell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",slyBlue:"#87ceeb",slateBlue:"#6a5acd",slateGray:"#708090",snow:"#fffafa",springGreen:"#00ff7f",steelBlue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whiteSmoke:"#f5f5f5",yellow:"#ffff00",yellowGreen:"#9acd32"},i={width:1,lineType:"solid",color:"#e3e3e3",radius:0},s={style:"normal",family:"Helvetica, sans-serif",size:12,weight:"normal",lineHeight:1.2,color:"#000"},e=Object.assign({},s,{weight:"bold"}),o={top:0,bottom:0,left:0,right:0},a={dpi:1,height:200,width:"100%",padding:{top:40,left:40,right:40,bottom:40},margin:o,background:"#fff",color:"#000",font:s,border:i,title:{display:!0,align:"center",
// start, center, end
rtl:!1,color:"#000",text:"",font:Object.assign({},s,{weight:"bold",size:24}),padding:{top:10,bottom:10,left:10,right:10}},legend:{rtl:!1,margin:o,padding:{top:0,bottom:0,left:0,right:0},font:e,border:i,dash:[],background:"#fff",vertical:!1,position:"top-left"},tooltip:{width:"auto",background:"#fff",color:"#000",font:s,border:i,padding:{top:10,bottom:10,left:10,right:10},shadow:{shiftX:2,shiftY:2,blur:4,stretch:0,color:"rgba(0,0,0,.5)"}},boundaries:!1,colors:Object.values(t),animate:!1,onDrawLabelY:null,onDrawLabelX:null,onTooltipShow:null,onHover:null,onLeave:null};
/**
     * Simple object check.
     * @param item
     * @returns {boolean}
     */
function h(t){return t&&"object"==typeof t&&!Array.isArray(t)}
/**
     * Deep merge two objects.
     * @param target
     * @param ...sources
     */function n(t,...i){if(!i.length)return t;const s=i.shift();if(h(t)&&h(s))for(const i in s)h(s[i])?(t[i]||Object.assign(t,{[i]:{}}),n(t[i],s[i])):Object.assign(t,{[i]:s[i]});return n(t,...i)}const l=(t,i,[s,e],{align:o="left",baseLine:a="middle",color:h="#000",stroke:n="#000",font:l,angle:r=0,translate:d=[0,0]}={})=>{const{style:c="normal",weight:f="normal",size:p=12,lineHeight:m=1,family:u="sans-serif"}=l;let g=0,b=0;"number"==typeof d?g=b=d:Array.isArray(d)&&([g,b]=d),t.save(),t.beginPath(),t.textAlign=o,t.fillStyle=h,t.strokeStyle=n,t.font=`${c} ${f} ${p}px/${m} ${u}`,t.translate(g,b),t.rotate(r*Math.PI/180),t.textBaseline=a;i.toString().split("\n").map(((i,o)=>{t.fillText(i,s,e+e*o*m)})),t.closePath(),t.restore()},r=(t,i,{font:s=null})=>{let e,o=0;if(t.save(),s){const{style:i="normal",weight:e="normal",size:o=12,lineHeight:a=1.2,family:h="sans-serif"}=s;t.font=`${i} ${e} ${o}px/${a} ${h}`}for(let s=0;s<i.length;s++)e=t.measureText(i[s][0]).width,e>o&&(o=e);return t.restore(),o},d=(t,[i,s,e],{color:o="#000",fill:a="#fff",size:h=1,dash:n=[]}={})=>{t.beginPath(),t.save(),t.setLineDash(n),t.lineWidth=h,t.strokeStyle=o,t.fillStyle=a,t.rect(i-e,s-e,2*e,2*e),t.fill(),t.stroke(),t.restore(),t.closePath()},c=t=>"number"==typeof t?{top:t,left:t,right:t,bottom:t}:t,f=t=>"number"==typeof t?{top:t,left:t,right:t,bottom:t}:t,p={legend(){return!0===this.options.legend.vertical?this.legendVertical():this.legendHorizontal()},legendHorizontal(){const t=this.options,i=c(t.padding),s=t.legend,e=this.ctx,o=this.legendItems;if(!s||!h(s))return;if(!o||!Array.isArray(o)||!o.length)return;const a=c(s.padding),n=f(s.margin);let p,m,u,g,b=0;g=s.font.size/2,p=s.font.size*s.font.lineHeight,u=i.top+this.viewHeight+(s.font.size+a.top+n.top),m=i.left+a.left+n.left;for(let t=0;t<o.length;t++){let[i,a,h]=o[t];b+=r(e,[[s.showValue?`${i} - ${h}`:i]],{font:s.font})+2*g+5}b=(this.viewWidth-b)/2;for(let h=0;h<o.length;h++){let[c,f,x]=o[h];const y=r(e,[[s.showValue?`${c} - ${x}`:c]],{font:s.font});m+y>this.viewWidth&&(m=i.left+a.left+n.left,u+=p),d(e,[b+m,u,g],{color:f,fill:f}),l(e,s.showValue?`${c} - ${x}`:c,[b+m+g+5,u+g/2],{color:s.font.color,stroke:s.font.color,font:t.font}),m+=g+y+20}},legendVertical(){const t=this.options,i=t.legend,s=i.font??t.font;let e,o,a,n=s.size/2;const p=this.ctx,m=this.legendItems;let u,g;const b=c(i.padding),x=f(i.margin),y=c(t.padding);if(i&&h(i)&&m&&Array.isArray(m)&&m.length){e=s.size*s.lineHeight,u=r(p,m,{font:s})+b.left+b.right+3*n+5,g=m.length*e+b.top+b.bottom+5,"top-left"===i.position?(o=b.left+x.left,a=b.top+x.top):"top-right"===i.position?(o=this.dpiWidth-u-x.right-y.right,a=b.top+x.top):"bottom-left"===i.position?(o=b.left+x.left,a=this.dpiHeight-g-b.bottom-x.bottom):(o=this.dpiWidth-u-x.right-b.right,a=this.dpiHeight-g-b.bottom-x.bottom),((t,[i,s,e,o],{color:a="#fff",borderColor:h="#000",dash:n=[],size:l=1}={})=>{t.save(),t.beginPath(),t.strokeStyle=h,t.fillStyle=a,t.setLineDash(n),t.lineWidth=l,t.clearRect(i,s,e,o),t.fillRect(i,s,e,o),l&&t.strokeRect(i,s,e,o),t.closePath(),t.restore()})(p,[o,a,u,g],{color:i.background,dash:i.dash,size:i.border.width,borderColor:i.border.color}),o+=n+5+b.left,a+=n+5+b.top;for(let t=0;t<m.length;t++){let[s,h,r]=m[t];d(p,[o,a,n],{color:h,fill:h}),l(p,i.showValue?`${s} - ${r}`:s,[o+n+5,a+1],{color:i.font.color,stroke:i.font.color,font:i.font}),a+=e}}}},m={showTooltip(t,i){const s=this.options;if(this.tooltip&&(this.tooltip.remove(),this.tooltip=null),!s.tooltip)return;let{x:e,y:o}=this.proxy.mouse;const a=document.createElement("div"),h=s.onTooltipShow,n=s.tooltip.font,l=s.tooltip.shadow,r=s.tooltip.border,d=c(s.tooltip.padding);a.style.position="fixed",a.style.border=`${r.width}px ${r.lineType} ${r.color}`,a.style.borderRadius=`${r.radius}`,a.style.padding=`${d.top}px ${d.right}px ${d.bottom}px ${d.left}px`,a.style.background=`${s.tooltip.background}`,a.style.font=`${n.style} ${n.weight} ${n.size}px/${n.lineHeight} ${n.family}`,a.style.boxShadow=`${l.shiftX}px ${l.shiftY}px ${l.blur}px ${l.color}`,a.innerHTML=h&&"function"==typeof h?h.apply(null,[t,i]):t,document.querySelector("body").appendChild(a),a.style.top=o-a.clientHeight-15+"px",a.style.left=e-a.clientWidth/2-5+"px",this.tooltip=a,setTimeout((()=>{this.tooltip&&(this.tooltip.remove(),this.tooltip=null)}),3e3)}};class u{constructor(t,i=[],s={},e="unknown"){if("string"==typeof t?this.el=document.querySelector(t):t instanceof HTMLElement&&(this.el=t),!this.el)throw new Error("You must define an element or a selector of element for chart container!");this.options=n({},a,s),this.data=i,this.canvas=null,this.ctx=null,this.raf=null,this.tooltip=null,this.legendItems=[],this.chartType=e,this.rect=this.el.getBoundingClientRect(),this.canvasRect=null,this.static=!1;const o=this;this.proxy=new Proxy({},{set(...t){const i=Reflect.set(...t);return o.raf=requestAnimationFrame(o.draw.bind(o)),i}}),this.options.border&&(this.el.style.border=`${this.options.border.width}px ${this.options.border.lineType} ${this.options.border.color}`),this.calcInternalValues(),this.createCanvas(),this.addEvents()}createCanvas(){this.canvas=document.createElement("canvas"),this.el.innerHTML="",this.el.style.overflow="hidden",this.el.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.setCanvasSize(),this.canvasRect=this.canvas.getBoundingClientRect()}setCanvasSize(){const t=this.options;this.canvas.style.height=this.height+"px",this.canvas.style.width=this.width+"px",this.canvas.width=t.dpi*this.width,this.canvas.height=t.dpi*this.height}calcInternalValues(){let t,i;const s=this.options,e=c(s.padding),o=this.el.getBoundingClientRect(),{width:a,height:h}=o;t=s.width.toString().includes("%")?a/100*parseInt(s.width):+s.width,i=s.height.toString().includes("%")?h/100*parseInt(s.height):+s.height,this.width=t,this.height=i,this.dpi=s.dpi,this.dpiHeight=this.dpi*i,this.dpiWidth=this.dpi*t,this.viewHeight=this.dpiHeight-(e.top+e.bottom),this.viewWidth=this.dpiWidth-(e.left+e.right),this.center=[this.dpiWidth/2,this.dpiHeight/2],this.radius=Math.min(this.viewHeight,this.viewWidth)/2}title(){const t=this.options.title,i=this.ctx;let s;if(!t||!t.text)return;const{text:e,align:o,color:a,font:h}=t;switch(o){case"center":s=this.dpiWidth/2;break;case"right":s=this.dpiWidth-5;break;default:s=5}l(i,e,[s,h.size+5],{align:t.align,color:t.color,stroke:t.color,font:t.font})}setBackground(t){t&&(this.options.background=t),this.ctx.fillStyle=this.options.background,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}draw(){this.clear(),this.setBackground(),this.title()}clear(){this.ctx.clearRect(0,0,this.dpiWidth,this.dpiHeight)}setData(t,i,s=!0){void 0!==i?this.data[i].data=t:this.data=t,s&&this.resize()}setBoundaries(t,i=!0){const s=["minX","minY","minZ","maxX","maxY","maxZ","min","max"];for(let i in t)s.includes(i)&&(this[i]=t[i],this.options.boundaries[i]=t[i]);i&&this.draw()}mouseMove(t){const i=this.options.onHover,{clientX:s,clientY:e}=t.changedTouches?t.touches[0]:t;"function"==typeof i&&i.apply(null,[s,e]),this.proxy.mouse={x:s,y:e},t.cancelable&&t.preventDefault()}mouseLeave(){const t=this.options.onLeave;"function"==typeof t&&t.apply(null,[]),this.proxy.mouse=null}resize(){this.calcInternalValues(),this.setCanvasSize(),this.rect=this.el.getBoundingClientRect(),this.canvasRect=this.canvas.getBoundingClientRect(),this.draw()}addEvents(){const t=this.canvas;t.addEventListener("mousemove",this.mouseMove.bind(this)),t.addEventListener("touchmove",this.mouseMove.bind(this),{passive:!1}),t.addEventListener("mouseleave",this.mouseLeave.bind(this)),window.addEventListener("resize",this.resize.bind(this))}destroy(){const t=this.canvas;cancelAnimationFrame(this.raf),t.removeEventListener("mousemove",this.mouseMove.bind(this)),t.removeEventListener("mouseleave",this.mouseLeave.bind(this)),window.removeEventListener("resize",this.resize.bind(this))}}Object.assign(u.prototype,p),Object.assign(u.prototype,m);const g={color:"#000",font:e,count:5,fixed:!1,opposite:!1,angle:0,align:"center",shift:{x:0,y:0},skip:0,showLine:!0,showLabel:!0,showMin:!0,step:"auto"},b={line:{color:"#e3e3e3",size:1,dash:[],shortLineSize:5},label:g},x={x:b,y:{...b,label:{...g,align:"right"}}},y={size:1,color:"#bbb",dash:[5,3]},w={color:"#7d7d7d",size:1,dash:[],factorX:5,factorY:5,outside:0},v={x:w,y:w},Y={axis:x,cross:y,showDots:!0,accuracy:2,arrows:v},X=(t=[],i="x")=>{let s,e,o,a;if("number"==typeof i)a=i;else switch(i.toString().toLowerCase()){case"y":a=1;break;case"z":a=2;break;default:a=0}for(const i of t)o=i[a],(isNaN(s)||s>o)&&(s=o),(isNaN(e)||e<o)&&(e=o);return[s,e]},k=(t=[])=>{let i,s;return i=Math.min.apply(null,t),s=Math.max.apply(null,t),[i,s]},z=(t,[i,s,e],{color:o="#000",fill:a="#fff",size:h=1}={})=>{t.beginPath(),t.save(),t.setLineDash([]),t.lineWidth=h,t.strokeStyle=o,t.fillStyle=a,t.arc(i,s,e,0,2*Math.PI),t.fill(),t.stroke(),t.restore(),t.closePath()},W=(t,[i,s,e],{color:o="#000",fill:a="#fff",size:h=1}={})=>{t.beginPath(),t.save(),t.setLineDash([]),t.lineWidth=h,t.strokeStyle=o,t.fillStyle=a,t.moveTo(i,s-e),t.lineTo(i+e,s+e),t.lineTo(i-e,s+e),t.lineTo(i,s-e),t.fill(),t.stroke(),t.restore(),t.closePath()},N=(t,[i,s,e],{color:o="#000",fill:a="#fff",size:h=1}={})=>{t.beginPath(),t.save(),t.setLineDash([]),t.lineWidth=h,t.strokeStyle=o,t.fillStyle=a,t.moveTo(i,s-e),t.lineTo(i+e,s),t.lineTo(i,s+e),t.lineTo(i-e,s),t.lineTo(i,s-e),t.fill(),t.stroke(),t.restore(),t.closePath()},M=(t,i=[],{color:s="#000",fill:e="#000",size:o=1,dash:a=[]}={})=>{t.beginPath(),t.save(),t.setLineDash(a),t.lineWidth=o,t.strokeStyle=s,t.fillStyle=e,i.map((([i,s])=>{t.lineTo(i,s)})),t.lineTo(i[0][0],i[0][1]),t.fill(),t.restore(),t.closePath()},S={cross(){const t=this.options,i=t.cross,s=c(t.padding),e=this.ctx,o=this.canvas.getBoundingClientRect();if(!t.cross||t.cross&&!this.proxy.mouse)return;let{x:a,y:h}=this.proxy.mouse;a-=o.left,h-=o.top,a-s.left+1<0||a>this.viewWidth+s.left+1||h-s.top+1<0||h>this.viewHeight+s.top+1||(e.beginPath(),e.setLineDash(t.cross.dash),e.lineWidth=i.size,e.strokeStyle=i.color,// vertical line
e.moveTo(a,s.top),e.lineTo(a,this.viewHeight+s.top),// Horizontal line
e.moveTo(s.left,h),e.lineTo(this.viewWidth+s.left,h),e.arc(a,h,10,0,2*Math.PI),e.stroke(),e.closePath())}},D=(t,[i,s,e,o],{color:a="#000",size:h=1,dash:n=[]}={})=>{t.beginPath(),t.save(),t.setLineDash(n),t.lineWidth=h,t.strokeStyle=a,t.moveTo(i,s),t.lineTo(e,o),t.stroke(),t.restore(),t.closePath()},T=(t,i)=>Math.ceil(t/i)*i,P={axisX(){const t=this.ctx,i=this.options,s=c(i.padding);if(!i.axis.x)return;const e=i.axis.x,o=e.label,a=e.line,h=e.arrow,n=(o&&o.font)??i.font,r=10**((""+this.maxX).length-2),d=T(this.maxX,r),f="auto"===o.step?o.count?(this.maxX-this.minX)/o.count:0:o.step?o.step:o.count?Math.ceil(d/o.count):0;let p,m,u,g,b,x,y=a.shortLineSize??0;g=s.left,b=s.top,x=s.top+this.viewHeight+n.size+5,m=this.minX,u=0;for(let e=0;e<=o.count;e++)p="number"==typeof o.fixed?m.toFixed(o.fixed):m,"function"==typeof i.onDrawLabelX&&(p=i.onDrawLabelX.apply(null,[m])),o.showLine&&D(t,[g,b,g,b+this.viewHeight],{color:a.color,size:a.size,dash:a.dash}),o.skip&&u!==o.skip?u++:(u=1,o.showLabel&&(e||o.showMin)&&(
// short line
D(t,[g,this.viewHeight+s.top-y,g,this.viewHeight+s.top+y],{color:h&&h.color?h.color:a.color}),// label
l(t,p.toString(),[0,0],{color:o.color??i.color,align:o.align,font:n,translate:[g+(o.shift.x??0),x+(o.shift.y??0)],angle:o.angle}))),m+=f,g=s.left+(m-this.minX)*this.ratioX},axisY(){const t=this.ctx,i=this.options,s=c(i.padding);if(!i.axis.y)return;const e=i.axis.y,o=e.label,a=e.line,h=e.arrow,n=(o&&o.font)??i.font,r=10**((""+this.maxY).length-2),d=T(this.maxY,r),f="auto"===o.step?o.count?(this.maxY-this.minY)/o.count:0:o.step?o.step:o.count?Math.ceil(d/o.count):0;let p,m,u,g,b,x,y;const w=a.shortLineSize??0;g=s.left,x=s.left,b=this.viewHeight+s.top,m=this.minY,u=0,o.opposite?(x+=this.viewWidth+10+w,y=s.left+this.viewWidth,o.align="left"):(x-=10,y=g-w);for(let e=0;e<o.count+1;e++)p="number"==typeof o.fixed?m.toFixed(o.fixed):m,"function"==typeof i.onDrawLabelY&&(p=i.onDrawLabelY.apply(null,[m])),o.showLine&&D(t,[g,b,this.viewWidth+s.left,b],{color:a.color,size:a.size,dash:a.dash}),0!==e&&o.skip&&u!==o.skip?u++:(u=1,o.showLabel&&(e||o.showMin)&&(
// short line
D(t,[y,b,y+2*w,b],{color:h&&h.color?h.color:a.color}),l(t,p.toString(),[0,0],{color:(o&&o.color)??i.color,align:o.align,font:n,translate:[x+(o.shift.x??0),b+1+(o.shift.y??0)],angle:o.angle}))),m+=f,b=s.top+this.viewHeight-(m-this.minY)*this.ratioY},axisXY(){if(this.options.axis)return this.axisX(),this.axisY(),this}},L={addPoint(t,i,s=!1){const e=this.options;let o;if(!this.data){this.data=[];for(let i=0;i<t+1;i++)this.data[i]=[]}o=this.data[t],s&&o.length&&(e.graphSize?o.length>=e.graphSize&&(o=o.slice(1)):o=o.slice(1)),this.data[t]=o,this.data[t].push(i)}},H=(t,i=[],{color:s="#000",size:e=1,dash:o=[]}={})=>{t.beginPath(),t.save(),t.setLineDash(o),t.lineWidth=e,t.strokeStyle=s,i.map((([i,s])=>{t.lineTo(i,s)})),t.stroke(),t.restore(),t.closePath()},A={arrowX(){const t=this.options,i=this.ctx,s=c(t.padding);if(!t.arrows.x)return;const e=t.arrows.x,o=s.left,a=this.viewHeight+s.top;((t,[i,s,e,o,a,h],{color:n="#000",dash:l=[],size:r=1}={})=>{t.beginPath(),t.strokeStyle=n,t.lineWidth=r,t.setLineDash(l),t.moveTo(i,s),t.lineTo(e,o),t.moveTo(e,o),t.lineTo(e-a,o-h),t.moveTo(e,o),t.lineTo(e-a,o+h),t.stroke(),t.closePath()})(i,[o,a,s.left+this.viewWidth+e.outside,a,e.factorX,e.factorY],{color:e.color,size:e.size,dash:e.dash})},arrowY(){const t=this.options,i=this.ctx,s=c(t.padding);if(!t.arrows.y)return;const e=t.arrows.y,o=s.left;((t,[i,s,e,o,a,h],{color:n="#000",dash:l=[],size:r=1}={})=>{t.beginPath(),t.strokeStyle=n,t.lineWidth=r,t.setLineDash(l),t.moveTo(i,s),t.lineTo(e,o),t.moveTo(e,o),t.lineTo(e-a,o+h),t.moveTo(e,o),t.lineTo(e+a,o+h),t.stroke(),t.closePath()})(i,[o,this.viewHeight+s.top,o,s.top-e.outside,e.factorX,e.factorY],{color:e.color,size:e.size,dash:e.dash})},arrows(){if(this.options.arrows)return this.arrowX(),this.arrowY(),this}};class C extends u{constructor(t,i=[],s={}){super(t,i,n({},Y,s),"area"),this.coords={},this.minX=0,this.maxX=0,this.minY=0,this.maxY=0,this.legendItems=[];const e=this.options.legend,o=this.options.areas,a=this.options.colors;if(e)for(let t=0;t<this.data.length;t++)this.legendItems.push([o[t].name,a[t]]);this.calcMinMax(),this.resize()}calcMinMax(){const t=this.options;let i=[];for(let t of this.data)if(Array.isArray(t))for(const[s,e]of t)i.push([s,e]);const[s,e]=X(i,"x"),[o,a]=X(i,"y");this.minX=t.boundaries&&!isNaN(t.boundaries.minX)?t.boundaries.minX:s,this.maxX=t.boundaries&&!isNaN(t.boundaries.maxX)?t.boundaries.maxX:e,this.minY=t.boundaries&&!isNaN(t.boundaries.minY)?t.boundaries.minY:o,this.maxY=t.boundaries&&!isNaN(t.boundaries.maxY)?t.boundaries.maxY:a,isNaN(this.minX)&&(this.minX=0),isNaN(this.maxX)&&(this.maxX=100),isNaN(this.minY)&&(this.minX=0),isNaN(this.maxY)&&(this.maxX=100)}calcRatio(){this.ratioX=this.viewWidth/(this.maxX===this.minX?this.maxX:this.maxX-this.minX),this.ratioY=this.viewHeight/(this.maxY===this.minY?this.maxY:this.maxY-this.minY)}areas(){const t=this.options,i=c(t.padding),s=this.ctx;let e;if(this.data&&this.data.length)for(let o=0;o<this.data.length;o++){const a=t.areas[o],h=this.data[o],n=a.color??t.colors[o],l=a.fill??n;e=[],e.push([i.left,this.viewHeight+i.top,0,0]);for(const[t,s]of h){let o=Math.floor((t-this.minX)*this.ratioX+i.left),a=Math.floor(this.viewHeight+i.top-(s-this.minY)*this.ratioY);e.push([o,a,t,s])}e.push([e[e.length-1][0],this.viewHeight+i.top,0,0]),M(s,e,{color:n,fill:l,size:a.size});let r,c=a.dots?a.dots:{type:"dot"},f={color:c.color??n,fill:c.fill??n,radius:c.size??4};switch(c.type){case"square":r=d;break;case"triangle":r=W;break;case"diamond":r=N;break;default:r=z}a.dots&&!1!==t.showDots&&e.map((([t,i],o)=>{o&&o<e.length-1&&r(s,[t,i,f.radius],f)})),this.coords[a.name]={area:a,coords:e,drawPointFn:r,opt:f},e.shift(),e.pop(),!1!==a.showLines&&H(s,e,{color:n,fill:l,size:a.size})}}floatPoint(){const t=this.options,i=this.ctx,s=this.canvas.getBoundingClientRect();let e=!1;if(!this.data||!this.data.length)return;if(!this.proxy.mouse)return;let{x:o,y:a}=this.proxy.mouse;const h=o-s.left,n=a-s.top;for(const s in this.coords){const o=this.coords[s],a=o.drawPointFn,l=o.opt;for(const[s,r,d,c]of o.coords){const f=+(t.accuracy||l.radius),p=s-f,m=s+f,u=r-f,g=r+f;if(h>p&&h<m&&"default"!==t.hoverMode&&a(i,[s,r,l.radius],{color:l.color,fill:l.fill}),h>p&&h<m&&n>u&&n<g){"default"===t.hoverMode&&a(i,[s,r,2*l.radius],{color:l.color,fill:l.fill}),t.tooltip&&(this.showTooltip([d,c],o.graph),e=!0);break}}!e&&this.tooltip&&(this.tooltip.remove(),this.tooltip=null)}}add(t,[i,s],e,o){this.addPoint(t,[i,s],e),this.minX=this.data[t][0][0],this.maxX=i,o?h(o)&&this.align(o):(s<this.minY&&(this.minY=s),s>this.maxY&&(this.maxY=s)),this.resize()}align({minX:t,maxX:i,minY:s,maxY:e}){let o=[];for(let t of this.data)if(Array.isArray(t))for(const[i,s]of t)o.push([i,s]);const[a,h]=X(o,"x"),[n,l]=X(o,"y");t&&(this.minX=a),s&&(this.minY=n),i&&(this.maxX=h),e&&(this.maxY=l)}draw(){super.draw(),this.calcRatio(),this.axisXY(),this.arrows(),this.areas(),this.floatPoint(),this.cross(),this.legend()}}Object.assign(C.prototype,S),Object.assign(C.prototype,P),Object.assign(C.prototype,L),Object.assign(C.prototype,A);const R={groupDistance:0,barDistance:0,axis:{...x},dataAxisX:!1,labels:{font:e,color:"#000"},arrows:v,onDrawLabel:null},B=(t,[i,s,e,o],{color:a="#000",fill:h="#fff",size:n=1,dash:l=[]}={})=>{t.beginPath(),t.save(),t.setLineDash(l),t.lineWidth=n,t.strokeStyle=a,t.fillStyle=h,t.rect(i,s,e,o),t.fill(),t.stroke(),t.restore(),t.closePath()};class $ extends u{constructor(t,i,s){super(t,i,n({},R,s),"bar"),this.groups=0,this.barWidth=0,this.maxY=0,this.maxX=0,this.minY=0,this.minX=0,this.viewAxis=this.options.dataAxisX?this.viewHeight:this.viewWidth,this.legendItems=[];const e=this.options.legend;if(e&&e.titles&&e.titles.length)for(let t=0;t<e.titles.length;t++)this.legendItems.push([e.titles[t],this.options.colors[t]]);this.calcMinMax(),this.resize()}calcMinMax(){const t=this.options;let i=[];for(let t in this.data)i=[].concat(i,this.data[t]);this.groups=this.data.length;const[,s]=k(i);this.maxX=this.maxY=t.boundaries&&!isNaN(t.boundaries.max)?t.boundaries.max:s,isNaN(this.maxX)&&(this.maxX=100),isNaN(this.maxY)&&(this.maxX=100)}calcRatio(){this.ratioX=this.ratioY=this.ratio=(this.options.dataAxisX?this.viewWidth:this.viewHeight)/(this.maxY===this.minY?this.maxY:this.maxY-this.minY)}calcBarWidth(){const t=this.options;let i=0;for(let t=0;t<this.data.length;t++)i+=Array.isArray(this.data[t])?this.data[t].length:1;let s=(t.dataAxisX?this.viewHeight:this.viewWidth)-(this.data.length+1)*t.groupDistance-(i-this.data.length)*t.barDistance;// space between bars
this.barWidth=s/i}bars(t=!1){const i=this.options,s=i.bars,e=c(i.padding),o=this.ctx,a=this.canvas.getBoundingClientRect();let h,n,r,d,f=!1;if(this.data&&this.data.length){this.proxy.mouse&&(r=this.proxy.mouse.x-a.left,d=this.proxy.mouse.y-a.top),h=t?e.left:e.left+i.groupDistance,n=t?e.top+i.groupDistance:this.viewHeight+e.top;for(let a=0;a<this.data.length;a++){const c=this.data[a],p=Array.isArray(c)?c:[c],m=i.labels.color;let u=s[a],g=0;for(let s=0;s<p.length;s++){let l=p[s]*this.ratio,m=1===p.length?i.colors[a]:i.colors[s];const b={color:m,fill:m},x=t?[h,n,h+l-e.right,this.barWidth]:[h,n-l,this.barWidth-1,l];B(o,x,b);const y=t?[h,h+l]:[h,h+this.barWidth-1],w=t?[n,n+this.barWidth-1]:[n-l,n];r>y[0]&&r<y[1]&&d>w[0]&&d<w[1]&&(B(o,x,{...b,fill:"rgba(255,255,255,.3)"}),i.tooltip&&(this.showTooltip([i.legend.titles?i.legend.titles[s]:u,p[s]],c),f=!0)),g+=this.barWidth+i.barDistance,t?n+=i.barDistance+this.barWidth:h+=i.barDistance+this.barWidth}t?n-=i.barDistance:h-=i.barDistance,g-=i.barDistance,"function"==typeof i.onDrawLabel&&(u=i.onDrawLabel.apply(null,u)),l(o,u,[0,0],{align:"center",color:m,stroke:m,font:i.font,angle:t?90:0,translate:t?[h-20,n-g/2]:[h-g/2,n+20]}),t?n+=i.groupDistance:h+=i.groupDistance}!f&&this.tooltip&&(this.tooltip.remove(),this.tooltip=null),this.static=!0}}draw(){const t=this.options;super.draw(),this.calcBarWidth(),this.calcRatio(),t.dataAxisX?this.axisX():this.axisY(),this.bars(t.dataAxisX),this.arrows(),this.legend()}}Object.assign($.prototype,P),Object.assign($.prototype,A);const I={axis:x,cross:y,arrows:v};class O extends u{constructor(t,i,s){super(t,i,n({},I,s),"bubble"),this.coords={},this.minX=0,this.maxX=0,this.minY=0,this.maxY=0,this.minZ=0,this.maxZ=0,this.legendItems=[];if(this.options.legend)for(let t=0;t<this.data.length;t++)this.legendItems.push([this.data[t].name,this.options.colors[t]]);this.calcMinMax(),this.resize()}calcMinMax(){const t=this.options;let i=[];for(let t in this.data){let s=this.data[t].data;Array.isArray(s)&&i.push(s)}const[s,e]=X(i,"x"),[o,a]=X(i,"y"),[h,n]=X(i,"z");this.minX=t.boundaries&&!isNaN(t.boundaries.minX)?t.boundaries.minX:s,this.maxX=t.boundaries&&!isNaN(t.boundaries.maxX)?t.boundaries.maxX:e,this.minY=t.boundaries&&!isNaN(t.boundaries.minY)?t.boundaries.minY:o,this.maxY=t.boundaries&&!isNaN(t.boundaries.maxY)?t.boundaries.maxY:a,this.minZ=t.boundaries&&!isNaN(t.boundaries.minZ)?t.boundaries.minZ:h,this.maxZ=t.boundaries&&!isNaN(t.boundaries.maxZ)?t.boundaries.maxZ:n,isNaN(this.minX)&&(this.minX=0),isNaN(this.maxX)&&(this.maxX=100),isNaN(this.minY)&&(this.minX=0),isNaN(this.maxY)&&(this.maxX=100),isNaN(this.minZ)&&(this.minX=0),isNaN(this.maxZ)&&(this.maxX=100)}calcRatio(){this.ratioX=this.viewWidth/(this.maxX===this.minX?this.maxX:this.maxX-this.minX),this.ratioY=this.viewHeight/(this.maxY===this.minY?this.maxY:this.maxY-this.minY),this.ratioZ=this.maxZ/(this.maxZ===this.minZ?this.maxZ:this.maxZ-this.minZ)}bubbles(){const t=this.options,i=c(t.padding),s=this.ctx;if(this.data&&this.data.length)for(let e=0;e<this.data.length;e++){const o=this.data[e],a=t.colors[e],[h,n,l]=o.data;let r=Math.floor((h-this.minX)*this.ratioX+i.left),d=Math.floor(this.viewHeight+i.top-(n-this.minY)*this.ratioY),c=Math.floor(l*this.ratioZ);z(s,[r,d,c],{fill:a,color:a})}}floatPoint(){this.data&&this.data.length}add(t,[i,s,e],o=!1){this.addPoint(t,[i,s,e],o),i<this.minX&&(this.minX=i),i>this.maxX&&(this.maxX=i),s<this.minY&&(this.minY=s),s>this.maxY&&(this.maxY=s),e<this.minZ&&(this.minZ=e),e>this.maxZ&&(this.maxZ=e),this.resize()}draw(){super.draw(),this.calcRatio(),this.axisXY(),this.arrows(),this.bubbles(),this.floatPoint(),this.cross(),this.legend()}}Object.assign(O.prototype,S),Object.assign(O.prototype,P),Object.assign(O.prototype,A);const j={barWidth:10,axis:{...x,x:{...x.x,arrow:!1},y:{...x.y,arrow:!1}},cross:y,graphSize:40,bars:{stroke:"#fff"}};class Z extends u{constructor(t,i=[],s={}){super(t,i,n({},j,s),"histogram"),this.coords={},this.minX=0,this.maxX=0,this.minY=0,this.maxY=0,this.legendItems=[];const e=this.options.legend,o=this.options.bars,a=this.options.colors;if(e)for(let t=0;t<this.data.length;t++)this.legendItems.push([o[t].name,a[t]]);this.calcMinMax(),this.resize()}calcMinMax(){const t=this.options;let i=[];for(let t of this.data)if(Array.isArray(t))for(const[s,e,o]of t)i.push([s,e,o]);const[s,e]=X(i,0),[o,a]=X(i,1),[h,n]=X(i,2);this.minX=t.boundaries&&!isNaN(t.boundaries.minX)?t.boundaries.minX:Math.min(s,o),this.maxX=t.boundaries&&!isNaN(t.boundaries.maxX)?t.boundaries.maxX:Math.max(e,a),this.minY=t.boundaries&&!isNaN(t.boundaries.minY)?t.boundaries.minY:h,this.maxY=t.boundaries&&!isNaN(t.boundaries.maxY)?t.boundaries.maxY:n,isNaN(this.minX)&&(this.minX=0),isNaN(this.maxX)&&(this.maxX=100),isNaN(this.minY)&&(this.minX=0),isNaN(this.maxY)&&(this.maxX=100)}calcRatio(){this.ratioX=this.viewWidth/(this.maxX===this.minX?this.maxX:this.maxX-this.minX),this.ratioY=this.viewHeight/(this.maxY===this.minY?this.maxY:this.maxY-this.minY)}bars(){const t=this.options,i=c(t.padding),s=this.ctx;if(this.data&&this.data.length)for(let e=0;e<this.data.length;e++){const o=t.bars[e],a=this.data[e],h=o.color||t.colors[e]||"#000",n=o.stroke||"#fff";for(const[t,e,o]of a){let a=Math.floor((t-this.minX)*this.ratioX+i.left),l=Math.floor((e-this.minX)*this.ratioX+i.left)-a,r=(o-this.minY)*this.ratioY,d=Math.floor(this.viewHeight+i.top-r);B(s,[a,d,l,r],{fill:h,color:n})}}}add(t,[i,s,e],o=!1){this.addPoint(t,[i,s,e],o),this.minX=this.data[t][0][0],this.maxX=s,e<this.minY&&(this.minY=e),e>this.maxY&&(this.maxY=e),this.resize()}draw(){super.draw(),this.calcRatio(),this.axisXY(),this.bars(),this.cross(),this.legend()}}Object.assign(Z.prototype,S),Object.assign(Z.prototype,P),Object.assign(Z.prototype,L);const G={hoverMode:"default",
// default, advanced
axis:x,cross:y,showDots:!0,type:"line",
// line, curve
accuracy:2,lines:[],arrows:v},V=(t,i=[],{color:s="#000",size:e=1,dash:o=[],tension:a=.25}={})=>{t.beginPath(),t.save(),t.setLineDash(o),t.lineWidth=e,t.strokeStyle=s,t.moveTo(i[0][0],i[0][1]);for(let s=0;s<i.length-1;s++){let e=(i[s][0]+i[s+1][0])/2,o=(i[s][1]+i[s+1][1])/2,a=(e+i[s][0])/2,h=(e+i[s+1][0])/2;//let cp_y2 = (y_mid + coords[i + 1][1]) / 2;
t.quadraticCurveTo(a,i[s][1],e,o),t.quadraticCurveTo(h,i[s+1][1],i[s+1][0],i[s+1][1])}t.stroke(),t.restore(),t.closePath()},q=(...t)=>{let i={};return t.forEach((t=>{t&&h(t)&&Object.assign(i,t)})),i},F="line",E="default";class K extends u{constructor(t,i=[],s={}){super(t,i,n({},G,s),"line"),this.coords={},this.minX=0,this.maxX=0,this.minY=0,this.maxY=0,this.legendItems=[];const e=this.options.legend,o=this.options.lines,a=this.options.colors;if(e)for(let t=0;t<o.length;t++)this.legendItems.push([o[t].name,a[t]]);this.calcMinMax(),this.resize()}calcMinMax(){const t=this.options;let i=[];for(let t of this.data)if(Array.isArray(t))for(const[s,e]of t)i.push([s,e]);const[s,e]=X(i,"x"),[o,a]=X(i,"y");this.minX=t.boundaries&&!isNaN(t.boundaries.minX)?t.boundaries.minX:s,this.maxX=t.boundaries&&!isNaN(t.boundaries.maxX)?t.boundaries.maxX:e,this.minY=t.boundaries&&!isNaN(t.boundaries.minY)?t.boundaries.minY:o,this.maxY=t.boundaries&&!isNaN(t.boundaries.maxY)?t.boundaries.maxY:a,isNaN(this.minX)&&(this.minX=0),isNaN(this.maxX)&&(this.maxX=100),isNaN(this.minY)&&(this.minX=0),isNaN(this.maxY)&&(this.maxX=100)}calcRatio(){this.ratioX=this.viewWidth/(this.maxX===this.minX?this.maxX:this.maxX-this.minX),this.ratioY=this.viewHeight/(this.maxY===this.minY?this.maxY:this.maxY-this.minY)}lines(){const t=this.options,i=c(t.padding),s=this.ctx;let e;if(this.data&&this.data.length)for(let o=0;o<this.data.length;o++){const a=t.lines[o],h=this.data[o],n=t.colors[o],l=a.type||t.type||F;e=[];for(const[t,s]of h){let o=Math.floor((t-this.minX)*this.ratioX+i.left),a=Math.floor(this.viewHeight+i.top-(s-this.minY)*this.ratioY);e.push([o,a,t,s])}!1!==a.showLine&&(l!==F?V(s,e,{color:n,size:a.size}):H(s,e,{color:n,size:a.size}));let r,c=q({type:"circle"},t.dots,a.dots),f={color:c.color??n,fill:c.fill??n,radius:c.size??2};switch(c.type){case"square":r=d;break;case"triangle":r=W;break;case"diamond":r=N;break;default:r=z}a.dots&&!1!==t.showDots&&e.map((([t,i])=>{r(s,[t,i,f.radius],f)})),this.coords[a.name]={line:a,coords:e,drawPointFn:r,opt:f}}}floatPoint(){const t=this.options,i=this.ctx,s=this.canvas.getBoundingClientRect();let e=!1;if(!this.data||!this.data.length)return;if(!this.proxy.mouse)return;let{x:o,y:a}=this.proxy.mouse;const h=o-s.left,n=a-s.top;for(const s in this.coords){const o=this.coords[s],a=o.drawPointFn,l=o.opt;// const graph = item.graph
for(const[s,r,d,c]of o.coords){const f=+(t.accuracy||l.radius),p=s-f,m=s+f,u=r-f,g=r+f;if(h>p&&h<m&&t.hoverMode!==E&&a(i,[s,r,l.radius],{color:l.color,fill:l.fill}),h>p&&h<m&&n>u&&n<g){t.hoverMode===E&&a(i,[s,r,2*l.radius],{color:l.color,fill:l.fill}),t.tooltip&&(this.showTooltip([d,c],o.graph),e=!0);break}}!e&&this.tooltip&&(this.tooltip.remove(),this.tooltip=null)}}add(t,[i,s],e,o){this.addPoint(t,[i,s],e),this.minX=this.data[t][0][0],this.maxX=i,o?h(o)&&this.align(o):(s<this.minY&&(this.minY=s),s>this.maxY&&(this.maxY=s)),this.resize()}align({minX:t,maxX:i,minY:s,maxY:e}){let o=[];for(let t of this.data)if(Array.isArray(t))for(const[i,s]of t)o.push([i,s]);const[a,h]=X(o,"x"),[n,l]=X(o,"y");t&&(this.minX=a),s&&(this.minY=n),i&&(this.maxX=h),e&&(this.maxY=l)}draw(){super.draw(),this.calcRatio(),this.axisXY(),this.arrows(),this.lines(),this.floatPoint(),this.cross(),this.legend()}}Object.assign(K.prototype,S),Object.assign(K.prototype,P),Object.assign(K.prototype,L),Object.assign(K.prototype,A);const J={other:{color:"#eaeaea"},labels:{font:e,color:"#fff"},showValue:!1,padding:0,onDrawValue:null},Q=(t,[i,s,e=4,o,a],{color:h="#000",fill:n="#fff",size:l=1}={})=>{t.beginPath(),t.save(),t.setLineDash([]),t.lineWidth=l,t.strokeStyle=h,t.fillStyle=n,t.arc(i,s,e,o,a),t.lineTo(i,s),t.fill(),t.stroke(),t.restore(),t.closePath()};class U extends u{constructor(t,i,s){super(t,i,n({},J,s),"pie"),this.total=this.data.reduce(((t,i)=>t+i),0),this.legendItems=[];const e=this.options.legend;if(e&&e.titles&&e.titles.length)for(let t=0;t<e.titles.length;t++)this.legendItems.push([e.titles[t],this.options.colors[t],this.data[t]]);this.resize()}sectors(){const t=this.ctx,i=this.options;let[s,e]=this.center;const o=this.radius;let a,h,n=0,d=360,c=0,f="";if(this.data&&this.data.length){for(let a=0;a<this.data.length;a++){let h=this.data[a],l=i.colors[a];d=2*Math.PI*h/this.total,Q(t,[s,e,o,n,n+d],{fill:l,color:l}),n+=d}n=0;for(let p=0;p<this.data.length;p++){let m,u=this.data[p],g=(this.legendItems[p]&&this.legendItems[p][0])??"";d=2*Math.PI*u/this.total,c=0,m=Math.round(100*u/this.total),f=i.showValue?u:m+"%","function"==typeof i.onDrawValue&&(f=i.onDrawValue.apply(null,[g,u,m])),a=s+(o/2+c)*Math.cos(n+d/2),h=e+(o/2+c)*Math.sin(n+d/2);let b=r(t,[u+"%"],{font:i.labels.font});l(t,f,[a-b/2,h+i.labels.font.size/2],{color:i.labels.color,font:i.labels.font}),n+=d}}}draw(){super.draw(),this.sectors(),this.legend()}resize(){super.resize(),this.center=[this.dpiWidth/2,this.dpiHeight/2]}}const _={groupDistance:0,axis:x,dataAxisX:!1,arrows:v,onDrawLabel:null};class tt extends u{constructor(t,i,s){super(t,i,n({},_,s),"stacked-bar"),this.barWidth=0,this.maxY=0,this.maxX=0,this.minY=0,this.minX=0,this.viewAxis=this.options.dataAxisX?this.viewHeight:this.viewWidth,this.ratioX=0,this.ratioY=0,this.legendItems=[];const e=this.options.legend;if(e&&e.titles&&e.titles.length)for(let t=0;t<e.titles.length;t++)this.legendItems.push([e.titles[t],this.options.colors[t]]);this.calcMinMax(),this.resize()}calcMinMax(){const t=this.options;let i=[];for(let t in this.data){let s=this.data[t].data;i.push(s.reduce(((t,i)=>t+i),0))}const[,s]=k(i);this.maxX=this.maxY=t.boundaries&&!isNaN(t.boundaries.max)?t.boundaries.maxY:s,isNaN(this.maxX)&&(this.maxX=100),isNaN(this.maxY)&&(this.maxX=100)}calcRatio(){this.ratio=this.ratioY=this.ratioX=(this.options.dataAxisX?this.viewWidth:this.viewHeight)/(this.maxY===this.minY?this.maxY:this.maxY-this.minY)}calcBarWidth(){const t=this.options;let i=this.data.length,s=(t.dataAxisX?this.viewHeight:this.viewWidth)-(this.data.length+1)*t.groupDistance;// space between groups
this.barWidth=s/i}barsX(){const t=this.options,i=c(t.padding),s=this.ctx;let e,o;const a=this.canvas.getBoundingClientRect();let h,n,r=!1;if(!this.data||!this.data.length)return;this.proxy.mouse&&(h=this.proxy.mouse.x-a.left,n=this.proxy.mouse.y-a.top),e=i.left,o=i.top+t.groupDistance;let d=Array.isArray(t.colors)?t.colors:t.colors.split(",").map((t=>t.trim()));for(const i of this.data){let a=i.data,c=i.name,f=d.length>1?t.color:d[0],p=0;for(let l=0;l<a.length;l++){let c=a[l]*this.ratio,f=d[l],m=d[l],u=t.values[l];B(s,[e+p,o,c,this.barWidth],{color:f,fill:m}),h>e+p&&h<e+c+p&&n>o&&n<o+this.barWidth&&(B(s,[e+p,o,c,this.barWidth-1],{color:"rgba(255,255,255,.3)",fill:"rgba(255,255,255,.3)"}),t.tooltip&&(this.showTooltip([u,a[l]],i),r=!0)),p+=c}o+=t.groupDistance+this.barWidth,"function"==typeof t.onDrawLabel&&(c=t.onDrawLabel.apply(null,c)),l(s,c,[0,0],{align:"center",color:f,stroke:f,font:t.font,translate:[e-20,o-this.barWidth/2],angle:90})}!r&&this.tooltip&&(this.tooltip.remove(),this.tooltip=null)}barsY(){const t=this.options,i=c(t.padding),s=this.ctx;let e,o;const a=this.canvas.getBoundingClientRect();let h,n,r=!1;if(!this.data||!this.data.length)return;this.proxy.mouse&&(h=this.proxy.mouse.x-a.left,n=this.proxy.mouse.y-a.top),e=i.left+t.groupDistance,o=this.viewHeight+i.top;let d=Array.isArray(t.colors)?t.colors:t.colors.split(",").map((t=>t.trim()));for(const i of this.data){let a=i.data,c=i.name,f=d.length>1?t.color:d[0],p=0;for(let l=0;l<a.length;l++){let c=a[l]*this.ratio,f=d[l],m=d[l],u=t.values[l];B(s,[e,o-c-p,this.barWidth,c],{color:f,fill:m}),h>e&&h<e+this.barWidth-1&&n>o-c-p&&n<o-p&&(B(s,[e,o-c-p,this.barWidth,c],{color:"rgba(255,255,255,.3)",fill:"rgba(255,255,255,.3)"}),t.tooltip&&(this.showTooltip([u,a[l]],i),r=!0)),p+=c}e+=t.groupDistance+this.barWidth,"function"==typeof t.onDrawLabel&&(c=t.onDrawLabel.apply(null,c)),l(s,c,[0,0],{align:"center",color:f,stroke:f,font:t.font,translate:[e-t.groupDistance-this.barWidth/2,o+20],angle:0})}!r&&this.tooltip&&(this.tooltip.remove(),this.tooltip=null)}draw(){const t=this.options;super.draw(),this.calcBarWidth(),this.calcRatio(),t.dataAxisX?(this.axisX(),this.barsX()):(this.axisY(),this.barsY()),this.arrows(),this.legend()}}Object.assign(tt.prototype,P),Object.assign(tt.prototype,A);const it={font:s,fixed:!1,color:"#000",angle:0,shift:{x:0,y:0}},st={backStyle:"#a7a7a7",fillStyle:"#8f8",startFactor:.85,endFactor:.15,backWidth:32,valueWidth:32,radius:100,boundaries:{min:0,max:100},value:it,label:{min:it,max:it},padding:{left:0,right:0}},et=(t,[i,s,e,o,a],{stroke:h="#000",fill:n="#fff",size:l=1,dash:r=[]}={})=>{t.beginPath(),t.save(),t.setLineDash(r),t.lineWidth=l,t.strokeStyle=h,t.fillStyle=n,t.arc(i,s,e,o,a),t.stroke(),t.restore(),t.closePath()},ot=(t,i)=>{let s="#fff",e=0;for(let o=0;o<i.length;o++){let a=i[o][0];t>=e&&t<=a&&(s=i[o][1],e=i[o][0])}return s};class at extends u{constructor(t,i,s){super(t,i,n({},st,s),"gauge"),this.min=this.options.boundaries.min,this.max=this.options.boundaries.max,this.resize()}gauge(){const t=this.ctx,i=this.options,s=c(i.padding);let[e,o]=this.center;e+=s.left,o+=s.top;const a=Math.PI,h=a*i.startFactor,n=a*(2+i.endFactor),r=i.radius*this.radius/100-i.backWidth;let d=this.data[0],f=Math.round(Math.abs(100*(d-this.min)/(this.max-this.min)));const p=h+(n-h)*f/100;let m=f,u=[];if("function"==typeof i.onDrawValue&&(m=i.onDrawValue.apply(null,[d,f])),et(t,[e,o,r,h,n],{size:i.backWidth,stroke:i.backStyle}),"string"==typeof i.fillStyle)u.push([100,i.fillStyle]);else if(Array.isArray(i.fillStyle))for(let t of i.fillStyle)u.push(t);et(t,[e,o,r,h,p],{size:i.valueWidth,stroke:ot(f,u)}),l(t,m,[0,0],{align:"center",baseLine:"middle",color:i.value.color,stroke:i.value.color,font:i.value.font||i.font,translate:[e+i.value.shift.x,o+i.value.shift.y],angle:i.value.angle}),i.label.min&&l(t,i.boundaries.min,[0,0],{align:"left",baseLine:"middle",color:i.label.min.color,stroke:i.label.min.color,font:i.label.min.font||i.font,translate:[e+r*Math.cos(h)+i.backWidth+i.label.min.shift.x,o+r*Math.sin(h)+i.label.min.shift.y],angle:0}),i.label.max&&l(t,i.boundaries.max,[0,0],{align:"right",baseLine:"middle",color:i.label.max.color,stroke:i.label.max.color,font:i.label.max.font||i.font,translate:[e+r*Math.cos(n)-i.backWidth+i.label.max.shift.x,o+r*Math.sin(n)+i.label.max.shift.y],angle:0})}draw(){super.draw(),this.gauge()}update(t,{min:i=null,max:s=null}={}){this.data[0]=t,null!==i&&(this.min=i),null!==s&&(this.max=s),this.resize()}}const ht={backStyle:"#a7a7a7",fillStyle:"#8f8",backWidth:100,valueWidth:100,radius:100,boundaries:{min:0,max:100},label:{font:s,fixed:!1,color:"#000",angle:0,shift:{x:0,y:0}},padding:0};class nt extends u{constructor(t,i,s){super(t,i,n({},ht,s),"donut"),this.total=this.data.reduce(((t,i)=>t+i),0),this.min=this.options.boundaries.min,this.max=this.options.boundaries.max,this.legendItems=[];const e=this.options.legend;if(e&&e.titles&&e.titles.length)for(let t=0;t<e.titles.length;t++)this.legendItems.push([e.titles[t],this.options.colors[t],this.data[t]]);this.resize()}gauge(){const t=this.ctx,i=this.options;let[s,e]=this.center;const o=Math.PI,a=this.radius-i.backWidth/2;et(t,[s,e,a,0,2*o],{size:i.backWidth,stroke:i.backStyle});let h=0,n=0;for(let o=0;o<this.data.length;o++){const r=i.colors[o];let d=this.data[o];if(n=2*Math.PI*d/this.total,et(t,[s,e,a,h,h+n],{size:i.valueWidth,stroke:r}),i.label){let r=(this.legendItems[o]&&this.legendItems[o][0])??"";const c=Math.round(100*d/this.total);let f,p,m=i.showValue?d:c+"%";"function"==typeof i.onDrawValue&&(m=i.onDrawValue.apply(null,[r,d,c])),f=s+a*Math.cos(h+n/2),p=e+a*Math.sin(h+n/2),l(t,m,[f,p],{color:i.label.color,font:i.label.font})}h+=n}}draw(){super.draw(),this.gauge(),this.legend()}resize(){super.resize(),this.center=[this.dpiWidth/2,this.dpiHeight/2]}}const lt={segment:{count:100,distance:4,rowDistance:4,height:"auto",radius:0},ghost:{color:"#f1f1f1"},colors:[[70,"#60a917"],[90,"#f0a30a"],[100,"#a20025"]],padding:0,margin:0},rt=(t,[i,s,e,o],{color:a="#000",fill:h="#fff",size:n=1,dash:l=[],radius:r=4}={})=>{if("number"==typeof r)r={tl:r,tr:r,br:r,bl:r};else{const t={tl:0,tr:0,br:0,bl:0};for(let i in t)r[i]=r[i]||t[i]}t.beginPath(),t.fillStyle=h,t.strokeStyle=a,t.moveTo(i+r.tl,s),t.lineTo(i+e-r.tr,s),t.quadraticCurveTo(i+e,s,i+e,s+r.tr),t.lineTo(i+e,s+o-r.br),t.quadraticCurveTo(i+e,s+o,i+e-r.br,s+o),t.lineTo(i+r.bl,s+o),t.quadraticCurveTo(i,s+o,i,s+o-r.bl),t.lineTo(i,s+r.tl),t.quadraticCurveTo(i,s,i+r.tl,s),t.fill(),t.stroke(),t.closePath()};class dt extends u{constructor(t,i,s){if(super(t,i,n({},lt,s),"segment"),this.min=0,this.max=100,"auto"!==this.options.segment.height){const t=this.options,i=t.segment,s=i.rowDistance*t.dpi;this.options.height=this.data.length*(s+1+i.height)}this.resize()}segments(){const t=this.ctx,i=this.options,s=i.segment,e=s.count?s.count:20,o=s.distance*i.dpi,a=s.rowDistance*i.dpi,h=this.viewWidth/e-o,n=[],l=c(i.padding);let r,d,f=l.top+o;if(d="auto"===s.height?(i.height-a*this.data.length)/this.data.length:s.height,"string"==typeof i.colors)n.push([100,i.colors]);else if(Array.isArray(i.colors))for(let t of i.colors)n.push(t);for(let c=0;c<this.data.length;c++){const p=e*this.data[c]/100;r=l.left+1;for(let a=0;a<e;a++){const l=ot(100*a/e,n);a<=p?rt(t,[r,f,h,d],{color:l,fill:l,radius:s.radius}):i.ghost&&rt(t,[r,f,h,d],{color:i.ghost.color,fill:i.ghost.color,radius:s.radius}),r+=h+o}f+=d+a}}setData(t,i=0,s=!0){this.data[i]=t,s&&this.resize()}draw(){super.draw(),this.segments()}}const ct={axis:x,boundaries:{minY:0},candle:{size:1,width:"auto",white:"green",black:"red",distance:4,cutoff:!1},ghost:{stroke:"#e3e3e3",fill:"#e3e3e3"},arrows:v},ft=(t,[i,s,e,o,a,h],{color:n="red",size:l=1,leg:r=!1}={})=>{t.beginPath(),t.save(),t.setLineDash([]),t.lineWidth=l,t.strokeStyle=n,t.fillStyle=n,t.moveTo(i,s),t.lineTo(i,s+e),r&&(t.moveTo(i-a/2,s),t.lineTo(i+a/2,s),t.moveTo(i-a/2,s+e),t.lineTo(i+a/2,s+e)),t.rect(i-a/2,o,a,h),t.stroke(),t.fill(),t.restore(),t.closePath()};class pt extends u{constructor(t,i,s){super(t,i,n({},ct,s),"candlesticks"),this.minY=0,this.maxY=0,this.labels=[],this.coords=[],this.calcMinMax(),this.resize()}calcMinMax(){const t=this.options;let i=[];this.labels.length=0;for(let t in this.data){const[s,e,o]=this.data[t];i.push([0,e]),i.push([0,o]),this.labels.push(s)}const[s,e]=X(i,"y");this.minY=t.boundaries&&!isNaN(t.boundaries.minY)?t.boundaries.minY:s,this.maxY=t.boundaries&&!isNaN(t.boundaries.maxY)?t.boundaries.maxY:e}calcRatio(){this.ratioY=this.viewHeight/(this.maxY===this.minY?this.maxY:this.maxY-this.minY)}getCandleSize(){const t=this.options.candle,i=this.data.length;return"auto"===t.width?(this.viewWidth-2*t.distance-t.distance*(i-1))/i:t.width}candlesticks(){
// data [x, hi, low, open, close]
const t=this.ctx,i=this.options,s=i.candle,e=i.ghost,o=c(i.padding),a=this.data.length,h=this.canvas.getBoundingClientRect();let n,l,r=this.getCandleSize(),d=!1;this.proxy.mouse&&(n=this.proxy.mouse.x-h.left,l=this.proxy.mouse.y-h.top);let f=o.left+r/2+s.distance;this.coords.length=0;for(let h=0;h<a;h++){let a,c,p,m,[u,g,b,x,y]=this.data[h];const w=y>x;let v=w?s.white:s.black,Y=f-r/2-s.distance/2,X=f+r/2+s.distance/2;a=o.top+this.viewHeight-(g-this.minY)*this.ratioY,c=o.top+this.viewHeight-(b-this.minY)*this.ratioY,p=o.top+this.viewHeight-(x-this.minY)*this.ratioY,m=o.top+this.viewHeight-(y-this.minY)*this.ratioY,n>=Y&&n<=X&&B(t,[Y,o.top,r+s.distance,this.viewHeight],{color:e.stroke,fill:e.fill}),ft(t,[f,a,c-a,p,r,m-p],{color:v,size:s.size,leg:s.leg}),n>=Y&&n<=X&&l>=a&&l<=c&&i.tooltip&&(this.showTooltip(this.data[h],{type:w}),d=!0),this.coords.push(f),f+=r+s.distance}!d&&this.tooltip&&(this.tooltip.remove(),this.tooltip=null)}axis(){
// draw default axis Y
this.axisY();// draw axis X
const t=this.ctx,i=this.options,s=i.candle,e=c(i.padding),o=i.axis.x,a=o.label,h=o.line,n=o.arrow,r=(a&&a.font)??i.font;let d=h.shortLineSize??0;const f=this.getCandleSize();let p=e.left+f/2+s.distance,m=e.top+this.viewHeight,u=0;for(let e=0;e<this.labels.length;e++){let o=this.labels[e],c=o;"function"==typeof i.onDrawLabelX&&(c=i.onDrawLabelX.apply(null,[o])),0!==e&&a.skip&&u!==a.skip?u++:(u=1,// short line
D(t,[p,m-d,p,m+d],{color:n&&n.color?n.color:h.color}),// label
l(t,c.toString(),[0,0],{color:a.color??i.color,align:a.align,font:r,translate:[p+(a.shift.x??0),m+r.size+5+(a.shift.y??0)],angle:a.angle})),p+=f+s.distance}}add([t,i,s,e,o],a=!1){const h=this.options;let n;this.data||(this.data=[]),n=this.data,a&&n.length&&(h.graphSize?n.length>=h.graphSize&&(n=n.slice(1)):n=n.slice(1)),this.data=n,this.data.push([t,i,s,e,o]),this.calcMinMax(),this.resize()}draw(){super.draw(),this.calcRatio(),this.axis(),this.arrows(),this.candlesticks()}}Object.assign(pt.prototype,P),Object.assign(pt.prototype,m),Object.assign(pt.prototype,A);globalThis.chart={areaChart:(t,i,s)=>new C(t,i,s),barChart:(t,i,s)=>new $(t,i,s),bubbleChart:(t,i,s)=>new O(t,i,s),histogramChart:(t,i,s)=>new Z(t,i,s),lineChart:(t,i,s)=>new K(t,i,s),pieChart:(t,i,s)=>new U(t,i,s),stackedBarChart:(t,i,s)=>new tt(t,i,s),gauge:(t,i,s)=>new at(t,i,s),donut:(t,i,s)=>new nt(t,i,s),segment:(t,i,s)=>new dt(t,i,s),candlestickChart:(t,i,s)=>new pt(t,i,s),defaultColors:t}}();
